<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libwifi: libwifi/parse/data/eapol.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libwifi<span id="projectnumber">&#160;0.0.3</span>
   </div>
   <div id="projectbrief">An 802.11 Frame Parsing and Generation library in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('eapol_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">eapol.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="eapol_8h_source.html">eapol.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="frame_8h_source.html">../../core/frame/frame.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="byteswap_8h_source.html">../../core/misc/byteswap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="llc_8h_source.html">../../core/misc/llc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_2misc_2security_8h_source.html">../../core/misc/security.h</a>&quot;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div>
<p><a href="eapol_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e082b2e71fa1af74ee439da7542c40a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#a2e082b2e71fa1af74ee439da7542c40a">libwifi_check_wpa_handshake</a> (struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *frame)</td></tr>
<tr class="memdesc:a2e082b2e71fa1af74ee439da7542c40a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> is deemed to be an EAPOL handshake if the following criteria is met:  <a href="eapol_8c.html#a2e082b2e71fa1af74ee439da7542c40a">More...</a><br /></td></tr>
<tr class="separator:a2e082b2e71fa1af74ee439da7542c40a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07acbc760788a2b1e262ff69b91e94d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#a07acbc760788a2b1e262ff69b91e94d7">libwifi_check_wpa_message</a> (struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *frame)</td></tr>
<tr class="memdesc:a07acbc760788a2b1e262ff69b91e94d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check what message of the WPA1/2 handshake is in the given frame.  <a href="eapol_8c.html#a07acbc760788a2b1e262ff69b91e94d7">More...</a><br /></td></tr>
<tr class="separator:a07acbc760788a2b1e262ff69b91e94d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0056d37a47b2b1bb1df7f144302e69e0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#a0056d37a47b2b1bb1df7f144302e69e0">libwifi_get_wpa_message_string</a> (struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *frame)</td></tr>
<tr class="memdesc:a0056d37a47b2b1bb1df7f144302e69e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a string describing the WPA handshake message inside a supplied <a class="el" href="structlibwifi__frame.html">libwifi_frame</a>.  <a href="eapol_8c.html#a0056d37a47b2b1bb1df7f144302e69e0">More...</a><br /></td></tr>
<tr class="separator:a0056d37a47b2b1bb1df7f144302e69e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc328cba8bc4a01d3d2fa37168f2f33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#acdc328cba8bc4a01d3d2fa37168f2f33">libwifi_get_wpa_key_data_length</a> (struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *frame)</td></tr>
<tr class="memdesc:acdc328cba8bc4a01d3d2fa37168f2f33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the length of the key data, if any, present at the end of an EAPOL frame.  <a href="eapol_8c.html#acdc328cba8bc4a01d3d2fa37168f2f33">More...</a><br /></td></tr>
<tr class="separator:acdc328cba8bc4a01d3d2fa37168f2f33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6036931738f69c6f5463b5818e44c05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#ab6036931738f69c6f5463b5818e44c05">libwifi_get_wpa_data</a> (struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *frame, struct <a class="el" href="structlibwifi__wpa__auth__data.html">libwifi_wpa_auth_data</a> *data)</td></tr>
<tr class="memdesc:ab6036931738f69c6f5463b5818e44c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the EAPOL/WPA information from a given <a class="el" href="structlibwifi__frame.html">libwifi_frame</a>.  <a href="eapol_8c.html#ab6036931738f69c6f5463b5818e44c05">More...</a><br /></td></tr>
<tr class="separator:ab6036931738f69c6f5463b5818e44c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ee590ccfd6c10b752b9968d7d82e13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eapol_8c.html#a50ee590ccfd6c10b752b9968d7d82e13">libwifi_free_wpa_data</a> (struct <a class="el" href="structlibwifi__wpa__auth__data.html">libwifi_wpa_auth_data</a> *data)</td></tr>
<tr class="memdesc:a50ee590ccfd6c10b752b9968d7d82e13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free any memory allocated inside of a libwifi_wpa_auth data, such as a buffer for WPA key data allocated by the library.  <a href="eapol_8c.html#a50ee590ccfd6c10b752b9968d7d82e13">More...</a><br /></td></tr>
<tr class="separator:a50ee590ccfd6c10b752b9968d7d82e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2e082b2e71fa1af74ee439da7542c40a" name="a2e082b2e71fa1af74ee439da7542c40a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e082b2e71fa1af74ee439da7542c40a">&#9670;&nbsp;</a></span>libwifi_check_wpa_handshake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libwifi_check_wpa_handshake </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> is deemed to be an EAPOL handshake if the following criteria is met: </p>
<p >Check if a <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> contains a WPA1/2 handshake message.</p>
<ul>
<li>The frame is of type TYPE_DATA, and</li>
<li>The frame contains a logical link control layer, and</li>
<li>There is enough data in the frame body to fill a <a class="el" href="structlibwifi__wpa__auth__data.html" title="libwifi Representation of the encapsulating 802.1X data in an EAPOL frame ┌─────────────────┐ │ Versi...">libwifi_wpa_auth_data</a> struct. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00034">34</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
<a id="a07acbc760788a2b1e262ff69b91e94d7" name="a07acbc760788a2b1e262ff69b91e94d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07acbc760788a2b1e262ff69b91e94d7">&#9670;&nbsp;</a></span>libwifi_check_wpa_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libwifi_check_wpa_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check what message of the WPA1/2 handshake is in the given frame. </p>
<p >The returned value can be used with the WPA_HANDSHAKE_PART enum, such as:</p>
<p >part = libwifi_check_wpa_message(frame); if (part &amp; HANDSHAKE_M1) { // This is EAPOL Message 1 }</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structlibwifi__frame.html">libwifi_frame</a></td><td>A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bitmask of parts. </dd></dl>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00074">74</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
<a id="a50ee590ccfd6c10b752b9968d7d82e13" name="a50ee590ccfd6c10b752b9968d7d82e13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ee590ccfd6c10b752b9968d7d82e13">&#9670;&nbsp;</a></span>libwifi_free_wpa_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libwifi_free_wpa_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__wpa__auth__data.html">libwifi_wpa_auth_data</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free any memory allocated inside of a libwifi_wpa_auth data, such as a buffer for WPA key data allocated by the library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>A pointer to a <a class="el" href="structlibwifi__wpa__auth__data.html" title="libwifi Representation of the encapsulating 802.1X data in an EAPOL frame ┌─────────────────┐ │ Versi...">libwifi_wpa_auth_data</a> struct </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00186">186</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
<a id="ab6036931738f69c6f5463b5818e44c05" name="ab6036931738f69c6f5463b5818e44c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6036931738f69c6f5463b5818e44c05">&#9670;&nbsp;</a></span>libwifi_get_wpa_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libwifi_get_wpa_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__wpa__auth__data.html">libwifi_wpa_auth_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the EAPOL/WPA information from a given <a class="el" href="structlibwifi__frame.html">libwifi_frame</a>. </p>
<p >As the values in the frame below and including the logical link control layer will be in network byte order, the values will be automatically byte swapped if necessary to match the host systems byte order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structlibwifi__frame.html">libwifi_frame</a></td><td>A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> </td></tr>
    <tr><td class="paramname">data</td><td>A pointer to a <a class="el" href="structlibwifi__wpa__auth__data.html" title="libwifi Representation of the encapsulating 802.1X data in an EAPOL frame ┌─────────────────┐ │ Versi...">libwifi_wpa_auth_data</a> struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00147">147</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
<a id="acdc328cba8bc4a01d3d2fa37168f2f33" name="acdc328cba8bc4a01d3d2fa37168f2f33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc328cba8bc4a01d3d2fa37168f2f33">&#9670;&nbsp;</a></span>libwifi_get_wpa_key_data_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libwifi_get_wpa_key_data_length </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the length of the key data, if any, present at the end of an EAPOL frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structlibwifi__frame.html">libwifi_frame</a></td><td>A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The length of the key data </dd></dl>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00127">127</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
<a id="a0056d37a47b2b1bb1df7f144302e69e0" name="a0056d37a47b2b1bb1df7f144302e69e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0056d37a47b2b1bb1df7f144302e69e0">&#9670;&nbsp;</a></span>libwifi_get_wpa_message_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * libwifi_get_wpa_message_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a string describing the WPA handshake message inside a supplied <a class="el" href="structlibwifi__frame.html">libwifi_frame</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structlibwifi__frame.html">libwifi_frame</a></td><td>A <a class="el" href="structlibwifi__frame.html">libwifi_frame</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A string describing the WPA handshake message found </dd></dl>

<p class="definition">Definition at line <a class="el" href="eapol_8c_source.html#l00105">105</a> of file <a class="el" href="eapol_8c_source.html">eapol.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a2de4624f71685afccadf203aa4d2aa9.html">libwifi</a></li><li class="navelem"><a class="el" href="dir_1622fc1c871defaa37183ce831a979a6.html">parse</a></li><li class="navelem"><a class="el" href="dir_967543a742fdba8f0862a6ef06d875f8.html">data</a></li><li class="navelem"><a class="el" href="eapol_8c.html">eapol.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
